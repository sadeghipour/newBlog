var app=angular.module("app",["ngSanitize","ui.router","ct.ui.router.extras","angularUtils.directives.dirPagination"]);app.factory("AppData",function(){return{}}),app.factory("EVENTS",function(){return{TODO_ADDED:"todo_added",TODO_DELETED:"todo_added",DATA_CHANGED:"data-changed"}}),app.config(function(paginationTemplateProvider){paginationTemplateProvider.setPath("/html_templates/dirPagination.tpl.html")}),app.config(function($stateProvider,$urlRouterProvider,$locationProvider,$urlMatcherFactoryProvider){$urlMatcherFactoryProvider.strictMode(!0),$locationProvider.html5Mode({enabled:!0,requireBase:!1}),$urlRouterProvider.otherwise("/"),$stateProvider.state("index",{url:"/",params:{title:{squash:!0,value:null}},views:{main:{templateUrl:function($state,$stateParams){return"/api/get-partial/index"},controller:"IndexController"}},onEnter:function($rootScope,$stateParams,EVENTS){console.log("onEnter Index")}}),$stateProvider.state("post",{url:"/post/:title",params:{title:{squash:!0,value:null}},views:{main:{templateUrl:function($state,$stateParams){return"/api/get-partial/post"},controller:"PostController"}},onEnter:function($rootScope,$stateParams,EVENTS){console.log("onEnter post view")}}),$stateProvider.state("me",{url:"/me",views:{main:{templateUrl:function($state,$stateParams){return"/api/get-partial/me"},controller:"MeController"}},onEnter:function($rootScope,$stateParams,EVENTS){console.log("onEnter post me")}}),$stateProvider.state("contact",{url:"/contact",views:{main:{templateUrl:function($state,$stateParams){return"/api/get-partial/contact"},controller:"ContactController"}},onEnter:function($rootScope,$stateParams,EVENTS){console.log("onEnter post Contact")}})}),app.controller("BannerController",function($scope){function init(){$scope.currentIndex=0,$scope.setCurrentSlideIndex=function(index){$scope.currentIndex=index},$scope.isCurrentSlideIndex=function(index){return $scope.currentIndex===index},$scope.prevSlide=function(){$scope.direction="left",$scope.currentIndex=$scope.currentIndex<$scope.post.image.length-1?++$scope.currentIndex:0},$scope.nextSlide=function(){$scope.direction="right",$scope.currentIndex=$scope.currentIndex>0?--$scope.currentIndex:$scope.post.image.length-1}}init()}),app.controller("ContactController",function($scope,WebService){}),app.controller("IndexController",function($scope,WebService){WebService.getAllPosts(function(result){$scope.lastPosts=result&&result.success?result.success:null,$scope.lastPosts&&$scope.lastPosts.map(function(val,index){val.description.length>250&&(val.image=val.image[0],val.description=val.description.substr(0,250)+"...")})})}),app.controller("LayoutController",function($scope,WebService){}),app.controller("MeController",function($scope,WebService){}),app.controller("PostController",function($scope,WebService,$location,$window,$sce,$timeout,$rootScope,EVENTS,$stateParams){$scope.init=function(){var params={title:$stateParams.title};WebService.getPostByTitle(params,function(result){$scope.post=result&&result.success?result.success:null,$scope.post&&(document.title=document.title+" | "+$scope.post.title,$scope.post.description=$sce.trustAsHtml($scope.post.description))})},$scope.init(),$rootScope.applyChanges=function(){Caman("#filtered_image",function(){for(var i=0;i<Object.keys($scope.camanObj).length;i++){var key=Object.keys($scope.camanObj)[i],value=$scope.camanObj[Object.keys($scope.camanObj)[i]];console.log(key),console.log(value),this[key](0),this[key](value)}this.render()})}}),angular.module("app").animation(".main-slide-animation",function(){return{addClass:function(element,className,done){var scope=element.scope();if("ng-hide"==className){var elem=$(element),finishPoint=elem.parent().width();"right"!==scope.direction&&(finishPoint=-finishPoint),TweenMax.to(elem,.3,{left:finishPoint,onComplete:done,ease:Cubic.easeOut})}else done()},removeClass:function(element,className,done){var scope=element.scope();if("ng-hide"==className){var elem=$(element);elem.removeClass("ng-hide");var startPoint=elem.parent().width();"right"===scope.direction&&(startPoint=-startPoint),TweenMax.set(elem,{left:startPoint}),TweenMax.to(elem,.3,{left:0,onComplete:done,ease:Cubic.easeOut})}else done()}}}),angular.module("app").directive("compileTemplate",function($compile,$parse){return{restrict:"A",link:function(scope,element,attr){var parsed=$parse(attr.ngBindHtml);scope.$watch(function(){return(parsed(scope)||"").toString()},function(){$compile(element,null,-9999)(scope)})}}}),angular.module("app").directive("camanCanvas",function(EVENTS,$rootScope){function link(scope,element,attrs){var canvas=element[0];Caman(canvas,"/img/post-comonJS.png",function(){for(var i=0;i<Object.keys(scope.camanObj).length;i++)this[Object.keys(scope.camanObj)[i]](scope.camanObj[Object.keys(scope.camanObj)[i]]);this.render()})}return{link:link}}),app.service("WebService",function($http){this.getAllPosts=function(callbackFunc){$http({url:"/api/getAllPosts",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(data){callbackFunc(data)}).error(function(data){callbackFunc([])})},this.getPostByTitle=function(params,callbackFunc){$http({url:"/api/getPostByTitle",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(params)}).success(function(data){callbackFunc(data)}).error(function(data){callbackFunc([])})}});